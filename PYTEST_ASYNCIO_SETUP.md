# üß™ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ pytest-asyncio –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## ‚úÖ **–¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°**

**–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å pytest-asyncio!**

### üìã **–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

1. **pytest.ini** ‚úÖ
   - `asyncio_mode = auto` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ asyncio
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ testpaths –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ñ–∞–π–ª–æ–≤

2. **requirements.txt** ‚úÖ
   - `pytest-asyncio>=0.21.0` - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –ø–ª–∞–≥–∏–Ω–∞
   - `pytest>=7.0.0` - —Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è –≤–µ—Ä—Å–∏—è pytest

3. **–¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã** ‚úÖ
   - –í—Å–µ async —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–º–µ—á–µ–Ω—ã `@pytest.mark.asyncio`
   - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ assert'—ã –¥–ª—è async –∫–æ–¥–∞

## üìÅ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤:**

### üóÇÔ∏è **–ü–∞–ø–∫–∞ tests/** (–æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã)
- `tests/test_integration.py` ‚úÖ - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- `tests/test_performance.py` ‚úÖ - —Ç–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏  
- `tests/conftest.py` ‚úÖ - —Ñ–∏–∫—Å—Ç—É—Ä—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### üìÑ **–ö–æ—Ä–Ω–µ–≤—ã–µ —Ç–µ—Å—Ç—ã** (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ)
- `test_chatgpt_functionality.py` ‚úÖ - —Ç–µ—Å—Ç—ã ChatGPT (–æ–±–Ω–æ–≤–ª–µ–Ω)
- `test_webhook.py` ‚úÖ - —Ç–µ—Å—Ç—ã webhook
- `test_*.py` - –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

## üîß **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest-asyncio:**

### pytest.ini
```ini
[tool:pytest]
asyncio_mode = auto  # ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ asyncio
testpaths = tests .  # ‚úÖ –ü–æ–∏—Å–∫ –≤ –ø–∞–ø–∫–µ tests –∏ –∫–æ—Ä–Ω–µ
python_files = test_*.py *_test.py  # ‚úÖ –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Ñ–∞–π–ª–æ–≤
```

### requirements.txt
```
pytest>=7.0.0           # ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π pytest
pytest-asyncio>=0.21.0  # ‚úÖ –ü–ª–∞–≥–∏–Ω –¥–ª—è asyncio
pytest-cov>=4.0.0       # ‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
```

## üìù **–ü—Ä–∞–≤–∏–ª–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è async —Ç–µ—Å—Ç–æ–≤:**

### ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```python
import pytest

@pytest.mark.asyncio
async def test_async_function():
    result = await some_async_function()
    assert result is not None
```

### ‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```python
import asyncio

async def test_async_function():  # –ë–µ–∑ @pytest.mark.asyncio
    result = await some_async_function()
    
def test_sync_function():
    result = asyncio.run(some_async_function())  # –ù–µ –Ω—É–∂–Ω–æ —Å pytest-asyncio
```

## üöÄ **–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:**

### –í—Å–µ —Ç–µ—Å—Ç—ã:
```bash
pytest -v
```

### –¢–æ–ª—å–∫–æ async —Ç–µ—Å—Ç—ã:
```bash
pytest -k "asyncio" -v
```

### –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π async —Ç–µ—Å—Ç:
```bash
pytest test_chatgpt_functionality.py::test_chatgpt_client_initialization -v
```

### –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞:
```bash
pytest --cov=. --cov-report=html -v
```

## üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|--------|----------|
| pytest-asyncio | ‚úÖ | –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω |
| asyncio_mode | ‚úÖ | auto - —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| @pytest.mark.asyncio | ‚úÖ | –í—Å–µ async —Ç–µ—Å—Ç—ã –ø–æ–º–µ—á–µ–Ω—ã |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã | ‚úÖ | –†–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |
| ChatGPT —Ç–µ—Å—Ç—ã | ‚úÖ | –û–±–Ω–æ–≤–ª–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã |

## üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **–í—Å–µ–≥–¥–∞ –ø–æ–º–µ—á–∞–π—Ç–µ async —Ñ—É–Ω–∫—Ü–∏–∏** –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–º `@pytest.mark.asyncio`
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ pytest.skip()** –¥–ª—è —Ç–µ—Å—Ç–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö –≤–Ω–µ—à–Ω–∏–µ API
3. **–ü–∏—à–∏—Ç–µ assert'—ã** —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ç–∏–ø–æ–≤ –¥–ª—è async —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–∫-–æ–±—ä–µ–∫—Ç—ã** –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---
üìù **–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 6 –∞–≤–≥—É—Å—Ç–∞ 2025  
üîß **–°—Ç–∞—Ç—É—Å:** –í—Å–µ —Ç–µ—Å—Ç—ã –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ —Å pytest-asyncio
